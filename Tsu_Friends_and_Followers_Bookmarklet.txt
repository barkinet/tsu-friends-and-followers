javascript:(function(){function e(){$("body.newsfeed").length?(g="home",v=".evac_user",w="body.newsfeed"):$("body.discover").length?(g="discover",v="body.discover .tree_child_fullname",w=""):$("#profile_feed").length?(g="diary",v=".evac_user",w="#profile_feed"):$("body.tree").length?(g="tree",v="body.tree .tree_child_fullname",w=".tree_page"):document.URL.contains("/post/")?(g="post",v=".evac_user",w=".post"):document.URL.endsWith("/friends")?(g="friends",v=".card .card_sub .info",w=".profiles_list"):document.URL.endsWith("/followers")?(g="followers",v=".card .card_sub .info",w=".profiles_list"):document.URL.endsWith("/following")?(g="following",v=".card .card_sub .info",w=".profiles_list"):(document.URL.contains("/messages/")||document.URL.endsWith("/messages"))&&(g="messages",v=".message_box .content",w=".messages_content")}function t(e){if(e){if(!confirm("Reload all Friend and Follower details of all users on the current page?"))return;u=[],h=[],$(".tff-span, .tff-br").remove(),$(".tff-processed").removeClass("tff-processed")}"discover"==g&&$("#discover .user_card_1_wrapper").each(function(){$currentUserLink=$(this).find(".tree_child_fullname");for(var e,t=$(this).find(".follow_button").attr("class").split(" "),r="follow_button_",n=t.length-1;n>=0;n--)if(r==t[n].slice(0,r.length)){e=t[n].substr(r.length);break}$currentUserLink.html($("<a/>",{href:"/users/"+e,html:$currentUserLink.html()}))}),$allUserLinks=$(v),$allUserLinks.each(function(){var e=$(this);if(!e.closest(".tooltipster-base").length){var t=e.attr("user_id");if("a"!=e.prop("tagName").toLowerCase()&&(e=e.find("a:first")),0!==e.length&&!e.hasClass("tff-processed")&&!e.siblings(".tff-span").length){var f=$("<span/>",{html:'<img class="tff-loader-wheel" src="/assets/loader.gif" title="Loading..." />',"class":"tff-span"});e.after(f),("friends"==g||"followers"==g||"following"==g||"discover"==g)&&f.before('<br class="tff-br" />');var l=e.text().trim(),d=e.attr("href");if(t="discover"==g?d.split("/")[2]:t||d.split("/")[1],s(t,!0))return a(t,f,0),void e.addClass("tff-processed");var c=o(t);return c instanceof r?(a(c,f,0),void e.addClass("tff-processed")):void $("<span/>").load(d+" .profile_details .numbers",function(r,s){if("success"==s){var o=$("a",this),c=$(o[0]),u=c.attr("href"),h=c.find("span").text(),p=$("<a/>",{title:"Friends",href:u,html:h}),m=$(o[1]),g=m.attr("href"),v=m.find("span").text(),w=$("<a/>",{title:"Followers",href:g,html:v});a(t,f),n(t,l,d,p,u,h,w,g,v),e.addClass("tff-processed")}else"error"==s&&$(this).html("n/a");i(t)})}}})}function r(e,t,r,n,s,i,o,a,f){this.userID=e.trim(),this.userName=t.trim(),this.userUrl=r.trim(),this.$friendsLink=n,this.friendsUrl=s.trim(),this.friendsCount=i.trim(),this.$followersLink=o,this.followersUrl=a.trim(),this.followersCount=f.trim(),this.getFriendsLink=function(){return this.$friendsLink.clone()},this.getFollowersLink=function(){return this.$followersLink.clone()}}function n(e,t,n,s,i,o,a,f,l){h.push(new r(e,t,n,s,i,o,a,f,l))}function s(e,t){for(var r=u.length-1;r>=0;r--)if(e==u[r])return!0;return t&&u.push(e),!1}function i(e){for(var t=u.length-1;t>=0;t--)if(e==u[t])return void delete u[t]}function o(e){for(var t=h.length-1;t>=0;t--)if(e==h[t].userID)return h[t];return!1}function a(e,t,n){(void 0===n||null===n)&&(n=0);var s;return e instanceof r?(s=e,e=s.userID):s=o(e),n>p?void t.remove():void(s instanceof r?t.empty().append(s.getFriendsLink(),s.getFollowersLink()):setTimeout(function(){a(e,t,n+1)},500))}function f(){if("discover"!=g)if("MutationObserver"in window){var e=document.querySelector(w);if(e){var t=new MutationObserver(function(e){for(var t=!1,r=e.length-1;r>=0;r--){var n=e[r].target.className;if(!n.contains("comment_time_from_now")&&!n.contains("time_to_update")){t=!0;break}}t&&b()});t.observe(e,{childList:!0,subtree:!0})}}else $.getScript("https://gist.github.com/raw/2625891/waitForKeyElements.js",function(){waitForKeyElements(v,b)})}function l(){$("<style>").html(".tff-span a {font-size:smaller;margin-left:5px;border-radius:3px;background-color:#1ABC9C;color:#fff !important;padding:2px 4px 0;}.tff-span .tff-loader-wheel {margin-left:5px;height:12px;}.user_card_1_wrapper .tree_child_fullname {height:32px !important;}.tff-update-link {background-color:#F1B054 !important;margin-top:15px !important;height:24px !important;box-sizing:border-box !important;}").appendTo("head")}function d(){if(0===$("#tff-menuitem-load-friends-and-followers").length){var e=$("<a/>",{html:"Load Friends and Followers"});e.click(function(){t(!0)});var r=$("<li/>",{id:"tff-menuitem-load-friends-and-followers",html:e});$("#navBarHead .sub_nav").append(r)}}function c(){$.get("https://cdn.rawgit.com/noplanman/tsu-friends-and-followers/master/VERSION",function(e){if(parseFloat(e)>m){$("<a/>",{title:"Update Friends and Followers script to the newest version ("+e+")",href:"https://greasyfork.org/scripts/6108-tsu-friends-and-followers/code/Tsu%20Friends%20and%20Followers.user.js",html:"Update!"}).addClass("button tff-update-link").attr("target","_blank").insertAfter(".tab.name").click(function(){return confirm("Upgrade to the newest version?\n\n(refresh this page after the script has been updated)")?void 0:!1})}})}l();var u=[],h=[],p=3e3;d();var m=1.1;c(),setTimeout(function(){e(),f()},500),setTimeout(function(){t()},1500);var g,v,w,_=!1,b=function(){_||(t(),setTimeout(function(){_=!1},2e3)),_=!0};"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return this.slice(0,e.length)==e}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return this.slice(-e.length)==e}),"function"!=typeof String.prototype.contains&&(String.prototype.contains=function(e){return this.indexOf(e)>=0})})();