javascript:(function(){function e(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var n="";var r,i,s;var o,u,a,f;var l=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(l<e.length){o=t.indexOf(e.charAt(l++));u=t.indexOf(e.charAt(l++));a=t.indexOf(e.charAt(l++));f=t.indexOf(e.charAt(l++));r=o<<2|u>>4;i=(u&15)<<4|a>>2;s=(a&3)<<6|f;n=n+String.fromCharCode(r);if(a!=64){n=n+String.fromCharCode(i)}if(f!=64){n=n+String.fromCharCode(s)}}return n}function f(){if($("body.newsfeed").length){a="home";l=".evac_user";w="body.newsfeed"}else if($("body.discover").length){a="discover";l="body.discover .tree_child_fullname";w=""}else if($("#profile_feed").length){a="diary";l=".evac_user";w="#profile_feed"}else if($("body.tree").length){a="tree";l="body.tree .tree_child_fullname";w=".tree_page"}else if(document.URL.contains("/post/")){a="post";l=".evac_user";w=".post"}else if(document.URL.endsWith("/friends")){a="friends";l=".card .card_sub .info";w=".profiles_list"}else if(document.URL.endsWith("/followers")){a="followers";l=".card .card_sub .info";w=".profiles_list"}else if(document.URL.endsWith("/following")){a="following";l=".card .card_sub .info";w=".profiles_list"}else if(document.URL.contains("/messages/")||document.URL.endsWith("/messages")){a="messages";l=".message_box .content";w=".messages_content"}}function c(e){if(e){if(confirm("Reload all Friend and Follower details of all users on the current page?")){n=[];r=[];$(".tff-span, .tff-br").remove();$(".tff-processed").removeClass("tff-processed")}else{return}}if("discover"==a){$("#discover .user_card_1_wrapper").each(function(){$currentUserLink=$(this).find(".tree_child_fullname");var e;var t=$(this).find(".follow_button").attr("class").split(" ");var n="follow_button_";for(var r=t.length-1;r>=0;r--){if(n==t[r].slice(0,n.length)){e=t[r].substr(n.length);break}}$currentUserLink.html($("<a/>",{href:"/users/"+e,html:$currentUserLink.html()}))})}$allUserLinks=$(l);$allUserLinks.each(function(){var e=$(this);if(e.closest(".tooltipster-base").length){return}var t=e.attr("user_id");if("a"!=e.prop("tagName").toLowerCase()){e=e.find("a:first")}if(0===e.length){return}if(e.hasClass("tff-processed")||e.siblings(".tff-span").length){return}var n=$("<span/>",{html:'<img class="tff-loader-wheel" src="/assets/loader.gif" title="Loading..." />',"class":"tff-span"});e.after(n);if("friends"==a||"followers"==a||"following"==a||"discover"==a){n.before('<br class="tff-br" />')}var r=e.text().trim();var i=e.attr("href");if("discover"==a){t=i.split("/")[2]}else{t=t||i.split("/")[1]}if(m(t,true)){b(t,n,0);e.addClass("tff-processed");return}var s=y(t);if(s instanceof d){b(s,n,0);e.addClass("tff-processed");return}$("<span/>").load(i+" .profile_details .numbers",function(s,o){if("success"==o){var u=$("a",this);var a=$(u[0]);var f=a.attr("href");var l=a.find("span").text();var c=$("<a/>",{title:"Friends",href:f,html:l});var h=$(u[1]);var p=h.attr("href");var d=h.find("span").text();var m=$("<a/>",{title:"Followers",href:p,html:d});b(t,n);v(t,r,i,c,f,l,m,p,d);e.addClass("tff-processed")}else if("error"==o){$(this).html("n/a")}g(t)})})}function d(e,t,n,r,i,s,o,u,a){this.userID=e.trim();this.userName=t.trim();this.userUrl=n.trim();this.$friendsLink=r;this.friendsUrl=i.trim();this.friendsCount=s.trim();this.$followersLink=o;this.followersUrl=u.trim();this.followersCount=a.trim();this.getFriendsLink=function(){return this.$friendsLink.clone()};this.getFollowersLink=function(){return this.$followersLink.clone()}}function v(e,t,n,i,s,o,u,a,f){r.push(new d(e,t,n,i,s,o,u,a,f))}function m(e,t){for(var r=n.length-1;r>=0;r--){if(e==n[r]){return true}}if(t){n.push(e)}return false}function g(e){for(var t=n.length-1;t>=0;t--){if(e==n[t]){delete n[t];return}}}function y(e){for(var t=r.length-1;t>=0;t--){if(e==r[t].userID){return r[t]}}return false}function b(e,t,n){if(undefined===n||null===n){n=0}var r;if(e instanceof d){r=e;e=r.userID}else{r=y(e)}if(n>i){t.remove();return}if(r instanceof d){t.empty().append(r.getFriendsLink(),r.getFollowersLink())}else{setTimeout(function(){b(e,t,n+1)},500)}}function E(){if("discover"==a){return}if("MutationObserver"in window){var e=document.querySelector(w);if(e){var t=new MutationObserver(function(e){var t=false;for(var n=e.length-1;n>=0;n--){var r=e[n].target.className;if(!r.contains("comment_time_from_now")&&!r.contains("time_to_update")){t=true;break}}if(t){p()}});t.observe(e,{childList:true,subtree:true})}}else{$.getScript("https://gist.github.com/raw/2625891/waitForKeyElements.js",function(){waitForKeyElements(l,p)})}}function S(){$("<style>").html(".tff-span a{font-size:smaller;margin-left:5px;border-radius:3px;background-color:#1ABC9C;color:#fff !important;padding:2px 4px 0;}.tff-span .tff-loader-wheel{margin-left:5px;height:12px;}.user_card_1_wrapper .tree_child_fullname{height:32px !important;}#tff-menuitem-update a:before{display:none !important;}").appendTo("head")}function x(){if(0===$("#tff-menuitem-load-friends-and-followers").length){var e=$("<a/>",{html:"Load Friends and Followers"});e.click(function(){c(true)});var t=$("<li/>",{id:"tff-menuitem-load-friends-and-followers",html:e});$("#navBarHead .sub_nav").append(t)}}function T(){$.getJSON(u,function(t){var n=parseFloat(e(t.content));if(n>o){$("#navBarHead .tab.name").css("background-color","#F1B054");if(0===$("#tff-menuitem-update").length){var r=$("<a/>",{title:"Update Friends and Followers script to the newest version ("+n+")",href:s,html:"Update Tsu F&F!"}).attr("target","_blank").css({"background-color":"#F1B054",color:"#fff"}).click(function(){if(!confirm("Upgrade to the newest version ("+n+")?\n\n(refresh this page after the script has been updated)")){return false}});$("<li/>",{id:"tff-menuitem-update",html:r}).appendTo("#navBarHead .sub_nav")}}})}if("function"!==typeof String.prototype.startsWith){String.prototype.startsWith=function(e){return this.slice(0,e.length)==e}}if("function"!==typeof String.prototype.endsWith){String.prototype.endsWith=function(e){return this.slice(-e.length)==e}}if("function"!==typeof String.prototype.contains){String.prototype.contains=function(e){return this.indexOf(e)>=0}}S();var t=false;var n=[];var r=[];var i=60;x();var s="https://greasyfork.org/scripts/6108-tsu-friends-and-followers/code/Tsu%20Friends%20and%20Followers.user.js";var o=1.2;var u="https://api.github.com/repos/noplanman/tsu-friends-and-followers/contents/VERSION";T();setTimeout(function(){f();E()},500);setTimeout(function(){c()},1500);var a;var l;var h=false;var p=function(){if(!h){c();setTimeout(function(){h=false},2e3)}h=true};var w})()